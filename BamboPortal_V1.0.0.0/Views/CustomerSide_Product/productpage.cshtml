@model BamboPortal_V1._0._0._0.ModelViews.CustomerSide.ProductDetail_ModelView
@{
    Layout = "~/Views/SharedViewPages/CustomerSide/CustomerMaster.cshtml";
    ViewBag.Title = Model.ProductModel.Title;
    ViewBag.SEOdescription = Model.ProductModel.SEO_Discription;
    ViewBag.SEOkeywords = Model.ProductModel.SEO_Keyword;
}

<div class="container ppres" style="padding-top: 80px;">
    <input id="JsonPF" style="display:none" value="@Model.JsonPF" />
    <input id="Sale_Products" style="display:none" value="@Model.JsonSale_Products" />
    <div class="row vertical-center-box">
        <div class="col-md-12 no-padding">
            <div id="shop-carousel" class="carousel slide no-margin col-md-6" data-ride="carousel" style="float: right">
                <div class="carousel-inner text-light">
                    @for (int i = 0; i < Model.ProductModel.org_Pictures.Count; i++)
                    {
                        if (i == 0)
                        {
                            <div class="item active">
                                <a href="@Url.Content("~"+Model.ProductModel.org_Pictures[i])" data-lightbox-gallery="gallery-shop">
                                    <img alt="image" class="img-responsive center-block" src="@Url.Content("~"+Model.ProductModel.org_Pictures[i])" onerror="this.onerror=null;this.src='/resource/images/Customes/imgNotFound.jpg'">
                                </a>
                            </div>
                        }
                        else
                        {
                            <div class="item">
                                <a href="@Url.Content("~"+Model.ProductModel.org_Pictures[i])" data-lightbox-gallery="gallery-shop">
                                    <img alt="image" class="img-responsive center-block" src="@Url.Content("~"+Model.ProductModel.org_Pictures[i])" onerror="this.onerror=null;this.src='/resource/images/Customes/imgNotFound.jpg'">
                                </a>
                            </div>
                        }
                    }


                    <!--<a class="left carousel-control single-prd-btn" href="#shop-carousel" role="button" data-slide="next">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a class="right carousel-control single-prd-btn" href="#shop-carousel" role="button" data-slide="prev">
                        <i class="fa fa-angle-right"></i>
                    </a>-->
                </div>
                <ul class="shop-thumbnails mar-bot-30">

                    @for (int i = 0; i < Model.ProductModel.Thumpnamil_Pictures.Count; i++)
                    {
                        if (i == 0)
                        {
                            <li>
                                <div data-target="#shop-carousel" data-slide-to="0">
                                    <a href="#" class="thumb thumb-active">
                                        <img alt="image" class="img-responsive" src="@Url.Content("~"+Model.ProductModel.Thumpnamil_Pictures[i])" onerror="this.onerror=null;this.src='/resource/images/Customes/imgNotFound.jpg'">
                                    </a>
                                </div>
                            </li>
                        }
                        else
                        {
                            <li>
                                <div data-target="#shop-carousel" data-slide-to="0">
                                    <a href="#" class="thumb">
                                        <img alt="image" class="img-responsive" src="@Url.Content("~"+Model.ProductModel.Thumpnamil_Pictures[i])" onerror="this.onerror=null;this.src='/resource/images/Customes/imgNotFound.jpg'">
                                    </a>
                                </div>
                            </li>
                        }
                    }

                </ul>
            </div>
            <section class="section-colored theme-background-light clearfix no-margin col-md-6" style="padding-bottom: 0px; padding-top: 40px;float: left;">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-12">
                            <h4 class="text-uppercase no-margin pad-bot-30 letter-spacing-1">
                                <strong>
                                    @Model.ProductModel.Title
                                </strong>
                            </h4>
                            <span class="desc-title pad-right-15 pad-left-15">
                                <i class="fa fa-chevron-left tshfatrtry3"></i>
                                توضیحات
                            </span>
                            <div class="tab-theme">
                                <div class="tab-content">
                                    <div id="tab1" class="tab-pane active no-padding-bottom prd-dtl-p0">
                                        <p class="pad-right-15 pad-left-15 mar-bot-30 text-justify">
                                            <small>
                                                @Model.ProductModel.Discription
                                            </small>
                                        </p>

                                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding">
                                            @foreach (var item in Model.ProductModel.Selectors)
                                            {
                                                <div class="select-option col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                    <span class="desc-title title-no-border">
                                                        <i class="fa fa-chevron-left tshfatrtry3"></i>
                                                        @item.Name_SCOK
                                                    </span>
                                                    <div class="custom-select" style="width:200px;">
                                                        <select id="SCOK-@item.ID_SCOK">
                                                            <option value="0">انتخاب @item.Name_SCOK</option>
                                                            @foreach (var ziritem in item.Options)
                                                            {
                                                                <option value="@ziritem.Key">@ziritem.Value</option>
                                                            }

                                                        </select>
                                                    </div>
                                                </div>
                                            }
                                        </div>

                                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="select-shop pad-right-15 pad-left-15 col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <span class="desc-title title-no-border">
                                                    <i class="fa fa-chevron-left tshfatrtry3"></i>
                                                    متراژ
                                                </span>
                                                <div>
                                                    <div class="mar-bot-30 met-input">
                                                        <input type='button' value='-' class='qtyminus btn pccm1' title='quantity1' />
                                                        <input id="QTM" type='text' value='1' class='qty mmmm' style="width:100px;" onchange="QTcalculator()" readonly />
                                                        <input type='button' value='+' class='qtyplus btn mccm1' title='quantity1' />
                                                        <p>متر</p>
                                                    </div>
                                                    <div class="mar-bot-30 met-input">
                                                        <input type='button' value='-' class='qtyminus btn pccm2' title='quantity1' />
                                                        <input id="QTCM" type='text' value='25' class='qty cmmm' style="width:100px;" onchange="QTcalculator()" readonly />
                                                        <input type='button' value='+' class='qtyplus btn mccm2' title='quantity1' />
                                                        <p>سانتی متر</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-12 col-md-2 col-sm-12 col-xs-12">
                                            <div class="text-left tshspbb col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                <div class="tshspbb-right col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <span class="price price-title" style="margin-top: 6px!important;" id="PriceVitrin">
                                                        @*String.Format("{0:n0}", )*@
                                                        @Model.ProductModel.MPCs[0].PriceXQ
                                                    </span>
                                                </div>
                                                <div class="tshspbb-left add-cart-btn col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                    <a href="#" class="btn btn-success btn-lg">
                                                        <i class="fa fa-shopping-cart" style="margin-left: 2px;"></i>
                                                        افزودن به سبد خرید
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <div class="row" style="margin-top: 30px;">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <h4 class="text-uppercase letter-spacing-1 no-margin col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <strong>
                    <i class="fa fa-chevron-left tshfatrtry3"></i>
                    مشخصات محصول
                </strong>
            </h4>
            <table class="table prd-det-border table-hover prod-det shop-table text-uppercase letter-spacing-1 mar-top-30 mar-bot-30 weight-400">
                @foreach (var item in Model.ProductModel.Options)
                {
                    <tr>
                        <td><small>@item.Key</small></td>
                        <td><small>@item.Value</small></td>
                    </tr>
                }
            </table>
        </div>
    </div>

    <div class="row" style="margin-top: 30px;">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <h4 class="text-uppercase letter-spacing-1 no-margin col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <strong>
                    <i class="fa fa-chevron-left tshfatrtry3"></i>
                    نظرات
                </strong>
            </h4>

            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <ul class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mar-top-30 mar-bot-30 comments">
                    @foreach (var item in Model.ProductModel.Comments)
                    {
                        <li class="col-lg-12 col-mg-12 col-sm-12 col-xs-12">

                            <h5>
                                <i class="fa fa-user"></i>
                                @item.Name
                                <date>
                                    @item.Date
                                    <i class="fa fa-calendar"></i>
                                </date>
                            </h5>
                            <p>
                                @item.Message
                            </p>
                            @foreach (var reps in item.Reply)
                            {


                                <div class="reply">
                                    <h5>
                                        <i class="fa fa-user"></i>
                                        @reps.Name
                                        <date>
                                            <i class="fa fa-calendar"></i>
                                            @reps.Date
                                        </date>
                                    </h5>
                                    <p>
                                        @reps.Message
                                    </p>
                                </div>
                            }
                        </li>

                    }
                </ul>
            </div>
            @if (ViewBag.IsUserLogin)
            {

                <form action="" method="post" autocomplete="off" id="account-form3" novalidate="novalidate">
                    <div class="form-group pad-bot-15 col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <label for="address" class="control-label text-uppercase letter-spacing-3 pad-bot-5" style="width: 100%;letter-spacing: 0px !important;">افزودن نظر</label>
                        <textarea class="form-control" name="address" id="address" maxlength="180"></textarea>
                    </div>
                    <div class="form-group pad-bot-15 col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <input type="submit" class="btn btn-success form-submit reg-submit" value="افزودن">
                    </div>
                </form>
            }
            else
            {
                <div class="form-group pad-bot-15 col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <a href="@Url.Action("loginandregister","CustomerSide_Register")" class="btn btn-success form-submit reg-submit">
                        برای ثبت نظر ابتدا وارد اکانت کاربری خود شوید
                    </a>
                </div>
            }
        </div>
    </div>

    <div class="container">
        <div class="row pad-top-100 cupt50">
            <div class="col-md-12 text-center" style="margin-bottom: 25px;">
                <h2 class="no-margin tshbb pad-bot-15 text-uppercase tshbb1b">پرفروش ترین محصولات</h2>
                <!--<h5 class="no-margin text-lighter"><i>Velvet Textile Gallery</i></h5>-->
            </div>
        </div>
        <div class="inner-res-margin-padding-0 row col-lg-12 col-md-12 col-sm-12 col-xs-12">
            @foreach (var item in Model.Sale_Products)
            {
                <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 pad-left-40 pad-right-40 no-padding-side-mobile">
                    <div class="trailer trailer-inactive-mobile no-margin-top">
                        <figure onclick="redirect('@Url.Action("productpage","CustomerSide_Product",new { M=item.MainCatename.Replace(" ","-") , S=item.subCatename.Replace(" ","-") ,  P=item.Id,N=item.Title.Replace(" ","-")})');" class="trailer-image">
                            <img alt="image" src="@Url.Content("~"+item.PicPath)" onerror="this.onerror=null;this.src='/resource/images/Customes/imgNotFound.jpg'" />
                            <figcaption>
                                <div class="trailer-center">
                                    <div class="trailer-heading custom-h2-title">
                                        <h2 class="content-background">Bags</h2>
                                    </div>
                                </div>
                            </figcaption>
                        </figure>
                    </div>
                    <div class="product-info">
                        <h3 onclick="redirect('@Url.Action("productpage","CustomerSide_Product",new { M=item.MainCatename.Replace(" ","-") , S=item.subCatename.Replace(" ","-") ,  P=item.Id,N=item.Title.Replace(" ","-")})');" class="text-darker"><a href="#"><small>@item.Title</small></a></h3>
                        <h6 class="price">
                            @String.Format("{0:n0}", item.PriceXQ)
                        </h6>
                    </div>
                </div>
            }

        </div>
    </div>

</div>







@section CS_Scripts {
    <script>
        var SenderRequest = {};
        var Qtbuys = "";
        var idmp = "";
        var searchObject;
        var Sale_Products;
        $(document).ready(function () {
            Qtbuys = $("#QTM").val() + "." + $("#QTCM").val();
            Qtbuys = Qtbuys.replace(".", "");
            searchObject = JSON.parse($("#JsonPF").val());
            Sale_Products = JSON.parse($("#Sale_Products").val());
            $(".pccm1").on("click", function () {
                var ThisNext = $(this).next();
                var mettDig = parseInt(ThisNext.val());
                if (mettDig <= 1) {
                    ThisNext.val(1)
                } else {
                    mettDig--;
                    ThisNext.val(mettDig)
                }
            })
            $(".mccm1").on("click", function () {
                var ThisPrev = $(this).prev();
                var mettDig = parseInt(ThisPrev.val());
                mettDig++;
                ThisPrev.val(mettDig)
            })
            $(".pccm2").on("click", function () {
                var ThisNext = $(this).next();
                var mettDig = parseInt(ThisNext.val());
                if (mettDig == 0) {
                    return false;
                } else {
                    var lastMett = mettDig - 25;
                    ThisNext.val(lastMett);
                }
            })
            $(".mccm2").on("click", function () {
                var ThisPrev = $(this).prev();
                var mettDig = parseInt(ThisPrev.val());
                if (mettDig == 75) {
                    return false;
                } else {
                    var lastMett = mettDig + 25;
                    ThisPrev.val(lastMett);
                }
            })
            $(".mmmm").on("keyup", function () {
                if ($(this).val() <= 1) {
                    $(this).val(1)
                }
            })
            $(".mmmm").on("change", function () {
                if ($(this).val() <= 1) {
                    $(this).val(1)
                }
            })
            $(".cmmm").on("change", function () {
                if ($(this).val() > 75) {
                    $(this).val(0)
                } else if ($(this).val() < 0) {
                    $(this).val(0)
                }
            })
        })



        var x, i, j, selElmnt, a, b, c;
        x = document.getElementsByClassName("custom-select");
        for (i = 0; i < x.length; i++) {
            selElmnt = x[i].getElementsByTagName("select")[0];
            a = document.createElement("DIV");
            a.setAttribute("class", "select-selected");
            a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
            x[i].appendChild(a);
            b = document.createElement("DIV");
            b.setAttribute("class", "select-items select-hide");
            for (j = 1; j < selElmnt.length; j++) {
                c = document.createElement("DIV");
                c.innerHTML = selElmnt.options[j].innerHTML;
                c.addEventListener("click", function (e) {
                    var y, i, k, s, h;
                    s = this.parentNode.parentNode.getElementsByTagName("select")[0];
                    h = this.parentNode.previousSibling;
                    for (i = 0; i < s.length; i++) {
                        if (s.options[i].innerHTML == this.innerHTML) {
                            s.selectedIndex = i;
                            //================================== SelectedIndex




                            //==================================

                            h.innerHTML = this.innerHTML;
                            y = this.parentNode.getElementsByClassName("same-as-selected");
                            for (k = 0; k < y.length; k++) {
                                y[k].removeAttribute("class");
                            }
                            this.setAttribute("class", "same-as-selected");
                            break;
                        }
                    }
                    h.click();
                });
                b.appendChild(c);
            }
            x[i].appendChild(b);
            a.addEventListener("click", function (e) {
                e.stopPropagation();
                closeAllSelect(this);
                this.nextSibling.classList.toggle("select-hide");
                this.classList.toggle("select-arrow-active");
            });
        }
        function closeAllSelect(elmnt) {
            var x, y, i, arrNo = [];
            x = document.getElementsByClassName("select-items");
            y = document.getElementsByClassName("select-selected");
            for (i = 0; i < y.length; i++) {
                if (elmnt == y[i]) {
                    arrNo.push(i)
                } else {
                    y[i].classList.remove("select-arrow-active");
                }
            }
            for (i = 0; i < x.length; i++) {
                if (arrNo.indexOf(i)) {
                    x[i].classList.add("select-hide");
                }
            }
        }
        document.addEventListener("click", closeAllSelect);


        function ProductCalculator() {
            var Code = "";
            $("select").each(function () {
                Code = Code + " " + $(this).val();
            });
            console.log(Code);
            Code = Code.replace(" ", "");

            var idMPC = "";
            for (var _Xi = 0; _Xi < searchObject.length; _Xi++) {
                if (searchObject[_Xi].Code == Code) {
                    idMPC = searchObject[_Xi].Idmpc;
                    idmp = idMPC;
                }
            }
            for (var _Xi = 0; _Xi < Sale_Products.length; _Xi++) {
                if (Sale_Products[_Xi].Id == idmp) {
                    $("#PriceVitrin").innerHTML = Sale_Products[_Xi].PriceXQ;
                }
            }
        }

        function QTcalculator() {
            Qtbuys = $("#QTM").val() + "." + $("#QTCM").val();
            Qtbuys = Qtbuys.replace(".", "");
        }


        function SendToBasket() {
            SenderRequest = {
                "Qtbuys": Qtbuys,
                "idmp": idmp
            };
            $.ajax({
                url: "",
                data: JSON.stringify(SenderRequest),
                type: "post",
                contentType: "application/json; charset=utf-8",
                success: function (data) {


                }, error: function () {

                }
            });
        }

    </script>





}